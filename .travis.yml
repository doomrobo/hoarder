language: go

go:
        - 1.6

env:
        - DATE=$(date '+%s') BUILD_VERSION='v0.1.0'

before_install:
        - go get github.com/mitchellh/gox
        - go get github.com/tcnksm/ghr

after_success:
        - gox -ldflags "-X 'main.buildVersion=$BUILD_VERSION ($TRAVIS_COMMIT)' -X 'main.buildDate=$DATE'" -output "dist/hoarder_{{.OS}}_{{.Arch}}" ./cmd/hoarder
        - ghr --username tblyler --token $GITHUB_TOKEN --replace --prerelease --debug $BUILD_VERSION dist/
